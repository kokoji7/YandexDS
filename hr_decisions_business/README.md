# Прогнозирование прибыли от нефтяных скважин
<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Прогнозирование-прибыли-от-нефтяных-скважин" data-toc-modified-id="Прогнозирование-прибыли-от-нефтяных-скважин-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Прогнозирование прибыли от нефтяных скважин</a></span><ul class="toc-item"><li><span><a href="#Описание-проекта" data-toc-modified-id="Описание-проекта-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Описание проекта</a></span></li><li><span><a href="#Описание-данных" data-toc-modified-id="Описание-данных-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Описание данных</a></span></li><li><span><a href="#Условия-задачи" data-toc-modified-id="Условия-задачи-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Условия задачи</a></span></li><li><span><a href="#Вывод" data-toc-modified-id="Вывод-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Вывод</a></span></li></ul></li></ul></div>









### Описание проекта

Проект направлен на поддержку HR-аналитиков компании «Работа с заботой» в решении двух ключевых задач: прогнозирования уровня удовлетворённости сотрудников и предсказания их увольнений. Эти задачи важны для предотвращения оттока сотрудников и минимизации финансовых потерь компании. Для их решения используется машинное обучение, что позволяет повышать точность и скорость аналитики.

### Описание данных

Для первой задачи, предсказания уровня удовлетворённости, предоставлены следующие признаки:  
- `id` — уникальный идентификатор сотрудника;  
- `dept` — отдел;  
- `level` — уровень должности;  
- `workload` — загруженность;  
- `employment_years` — стаж в компании;  
- `last_year_promo` — было ли повышение за последний год;  
- `last_year_violations` — нарушения трудового договора;  
- `supervisor_evaluation` — оценка работы руководителем;  
- `salary` — ежемесячная зарплата;  
- `job_satisfaction_rate` — уровень удовлетворённости (целевой признак).  

Для второй задачи, предсказания увольнений, используется тот же набор входных признаков, но целевым признаком выступает `quit` — факт увольнения.

### Условия задачи

#### Задача 1: Предсказание уровня удовлетворённости  
1. **Шаг 1: Загрузка данных.**  
   Данные загружаются из файлов `train_job_satisfaction_rate.csv`, `test_features.csv` и `test_target_job_satisfaction_rate.csv`.  
2. **Шаг 2: Предобработка данных.**  
   Изучение данных, заполнение пропусков в пайплайне.  
3. **Шаг 3: Исследовательский анализ данных.**  
   Анализ признаков и их подготовка.  
4. **Шаг 4: Подготовка данных.**  
   Использование пайплайнов и кодировщиков (не менее двух).  
5. **Шаг 5: Обучение моделей.**  
   Обучение минимум двух моделей (линейная модель и дерево решений). Оценка качества с использованием метрики SMAPE.  
   - **Критерий успеха:** SMAPE ≤ 15.  
6. **Шаг 6: Оформление выводов.**  
   Выбор лучшей модели и объяснение её эффективности.

#### Задача 2: Предсказание увольнений  
1. **Шаг 1: Загрузка данных.**  
   Данные загружаются из файлов `train_quit.csv`, `test_features.csv`, и `test_target_quit.csv`.  
2. **Шаг 2: Предобработка данных.**  
   Изучение и обработка пропусков.  
3. **Шаг 3: Исследовательский анализ данных.**  
   - Создание портрета «уволившегося сотрудника».  
   - Анализ связи между `job_satisfaction_rate` и `quit`.  
4. **Шаг 4: Добавление нового признака.**  
   Использование предсказанного `job_satisfaction_rate` из первой задачи.  
5. **Шаг 5: Подготовка данных.**  
   Подготовка в пайплайне с учётом особенностей признаков и моделей.  
6. **Шаг 6: Обучение моделей.**  
   Обучение не менее трёх моделей с подбором гиперпараметров.  
   - **Метрика:** ROC-AUC ≥ 0.91.  
7. **Шаг 7: Выводы.**  
   Оценка качества моделей и объяснение результатов.

### Вывод

Мы провели обучение модели, создав пайплайн с использованием следующих алгоритмов: DecisionTreeClassifier, KNeighborsClassifier и RandomForestClassifier. Обучение проводилось как на исходных данных, так и на объединённых данных с выделением признака.

Параметры наилучшей модели:
- 'preprocessor__num': 'passthrough',
- 'models__max_features': 8,
- 'models__max_depth': 4,
- 'models': DecisionTreeClassifier(random_state=100)}
Метрика наилучшей модели на тренировочной выборке составила 0.901. Значение метрики ROC-AUC на тестовой выборке для наилучшей модели составило 0.911.
