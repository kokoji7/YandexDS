# Прогнозирование прибыли от нефтяных скважин
<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Прогнозирование-прибыли-от-нефтяных-скважин" data-toc-modified-id="Прогнозирование-прибыли-от-нефтяных-скважин-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Прогнозирование прибыли от нефтяных скважин</a></span><ul class="toc-item"><li><span><a href="#Описание-проекта" data-toc-modified-id="Описание-проекта-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Описание проекта</a></span></li><li><span><a href="#Описание-данных" data-toc-modified-id="Описание-данных-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Описание данных</a></span></li><li><span><a href="#Условия-задачи" data-toc-modified-id="Условия-задачи-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Условия задачи</a></span></li><li><span><a href="#Вывод" data-toc-modified-id="Вывод-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Вывод</a></span></li></ul></li></ul></div>









## Описание проекта
Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.
«В один клик» — современная компания, поэтому её руководство не хочет принимать решения просто так — только на основе анализа данных и бизнес-моделирования. У компании есть небольшой отдел цифровых технологий, и вам предстоит побыть в роли стажёра в этом отделе. 
Итак, вашему отделу поручили разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.


## Описание данных


### market_file.csv
Таблица, которая содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.
-	id — номер покупателя в корпоративной базе данных.
-	Покупательская активность — рассчитанный класс покупательской активности (целевой признак): «снизилась» или «прежний уровень».
-	Тип сервиса — уровень сервиса, например «премиум» и «стандарт».
-	Разрешить сообщать — информация о том, можно ли присылать покупателю дополнительные предложения о товаре. Согласие на это даёт покупатель.
-	Маркет_актив_6_мес — среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев. Это значение показывает, какое число рассылок, звонков, показов рекламы и прочего приходилось на клиента.
-	Маркет_актив_тек_мес — количество маркетинговых коммуникаций в текущем месяце.
-	Длительность — значение, которое показывает, сколько дней прошло с момента регистрации покупателя на сайте.
-	Акционные_покупки — среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев.
-	Популярная_категория — самая популярная категория товаров у покупателя за последние 6 месяцев.
- Средний_просмотр_категорий_за_визит — показывает, сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца.
-	Неоплаченные_продукты_штук_квартал — общее число неоплаченных товаров в корзине за последние 3 месяца.
-	Ошибка_сервиса — число сбоев, которые коснулись покупателя во время посещения сайта.
-	Страниц_за_визит — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.

  
### market_money.csv
Таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом.
-	id — номер покупателя в корпоративной базе данных.
-	Период — название периода, во время которого зафиксирована выручка. Например, 'текущий_месяц' или 'предыдущий_месяц'.
-	Выручка — сумма выручки за период.

### market_time.csv
Таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода.
-	id — номер покупателя в корпоративной базе данных.
-	Период — название периода, во время которого зафиксировано общее время.
-	минут — значение времени, проведённого на сайте, в минутах.

### money.csv
Таблица с данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю.
-	id — номер покупателя в корпоративной базе данных.
-	Прибыль — значение прибыли.




## Условия задачи
- Обучите четыре модели: KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() и  SVC(). Для каждой из них подберите как минимум один гиперпараметр. Выберите подходящую для задачи метрику, аргументируйте свой выбор. Используйте эту метрику при подборе гиперпараметров.
- Во время подготовки данных используйте ColumnTransformer.
  
## Вывод
Исследование было направлено на создание модели для прогнозирования снижения покупательской активности в интернет-магазине "В один клик" и анализ выбранного сегмента пользователей.

Этапы исследования:

1. Загрузка данных:
В исследовании использовались четыре csv файла:

* данные о поведении покупателей на сайте и их взаимодействии с магазином,
* информация о выручке от каждого покупателя,
* время, проведённое покупателями на сайте,
* средняя месячная прибыль за последние три месяца. Данные были загружены в датафреймы с помощью библиотеки pandas.

2. Предобработка данных:
Данные были хорошего качества, но потребовали некоторых подготовительных работ:

* стандартизация имён признаков: пробелы заменены на подчеркивания.
* обработка ошибок в данных
* обработка пропусков: пропусков не было.

3. исследовательский анализ данных:

Были выявлены небольшое количество явно аномальных значений, которые были отброшены из рассмотрения. Так же оставили только пользователей, совершавших покупки в течении трех последних месяцев.

4. Объединение таблиц:

Датасеты были объединены в один датафрейм.

5. Корреляционный анализ:

Целевой признак - Покупательская активность. Были выявлены корреляции с признаками: Маркет_актив_6_мес, Акционные_покупки и другие.

6. Обучение модели:

Были обучены модели KNeighborsClassifier, DecisionTreeClassifier, LogisticRegression и SVC с использованием пайплайнов sklearn. Лучшая модель - SVC с параметрами probability=True и random_state=42 с метрикой roc_auc 0.90 для обучающей выборки и 0.91 для тестовой. Метрика f1 = 0.90.

7. Анализ важности признаков:

Самыми важными оказались признаки, связанные с количеством времени, проведённым на сайте. Менее важны - категории товаров и коммуникации с пользователем.

8. Сегментация пользователей:

Для анализа был выбран сегмент пользователей, часто покупающих по скидке и имеющих высокую вероятность снижения покупательской активности. Моё предложение по увеличению активности этого сегмента – таргетированная настройка главной страницы маркетплейса и более частое обновление скидок на главной странице. Пользователь не хочет переходить по страницам, он хочет видеть все предложения в одном месте.   
