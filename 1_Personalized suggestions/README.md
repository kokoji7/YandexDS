# Прогнозирование прибыли от нефтяных скважин
<h1>Содержание<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Прогнозирование-прибыли-от-нефтяных-скважин" data-toc-modified-id="Прогнозирование-прибыли-от-нефтяных-скважин-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Прогнозирование прибыли от нефтяных скважин</a></span><ul class="toc-item"><li><span><a href="#Описание-проекта" data-toc-modified-id="Описание-проекта-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Описание проекта</a></span></li><li><span><a href="#Описание-данных" data-toc-modified-id="Описание-данных-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Описание данных</a></span></li><li><span><a href="#Условия-задачи" data-toc-modified-id="Условия-задачи-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Условия задачи</a></span></li><li><span><a href="#Вывод" data-toc-modified-id="Вывод-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Вывод</a></span></li></ul></li></ul></div>









## Описание проекта
К вам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».
Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже.
Поэтому он просит вас разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах.


## Описание данных


Вы можете их скачать, нажав на название каждого.
1.	Файл ferma_main.csv содержит данные о стаде фермера на текущий момент. Описание данных: 
-	id — уникальный идентификатор коровы.
-	Удой, кг — масса молока, которую корова даёт в год (в килограммах).
-	ЭКЕ (Энергетическая кормовая единица) — показатель питательности корма коровы.
-	Сырой протеин, г — содержание сырого протеина в корме (в граммах).
-	СПО (Сахаро-протеиновое соотношение) — отношение сахара к протеину в корме коровы.
-	Порода — порода коровы.
-	Тип пастбища — ландшафт лугов, на которых паслась корова.
-	порода папы_быка — порода папы коровы.
-	Жирность,% — содержание жиров в молоке (в процентах).
-	Белок,% — содержание белков в молоке (в процентах).
-	Вкус молока — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно).
-	Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).
2.	Файл ferma_dad.csv хранит имя папы каждой коровы в стаде фермера. Описание данных: 
-	id — уникальный идентификатор коровы.
-	Имя Папы — имя папы коровы.
3.	Файл cow_buy.csv — это данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой. Описание данных: 
-	Порода — порода коровы.
-	Тип пастбища — ландшафт лугов, на которых паслась корова.
-	порода папы_быка — порода папы коровы.
-	Имя_папы — имя папы коровы.
-	Текущая_жирность,% — содержание жиров в молоке (в процентах).
-	Текущий_уровень_белок,% — содержание белков в молоке (в процентах).
-	Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).
Данные в файлах ferma_main.csv и cow_buy.csv похожи, но у датасета cow_buy.csv несколько особенностей.
-	Содержание белков и жиров в молоке указано на момент продажи — когда «ЭкоФерма» давала коровам свой корм.
-	Параметры корма ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г и СПО (Сахаро-протеиновое соотношение) отсутствуют. Технологи заказчика пересмотрели подход к кормлению: для новых коров планируется увеличить значения каждого из этих параметров на 5%.
-	Кроме того, отсутствуют признаки Удой, кг и Вкус молока. Это целевые признаки, именно их предстоит предсказать!




## Условия задачи
Вам нужно создать две прогнозные модели для отбора бурёнок в поголовье:
- Первая будет прогнозировать возможный удой коровы (целевой признак Удой);
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).
С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.

## Вывод

Среди построенных линейных регрессий для прогнозирования удоя была выбрана регрессия, в которую в итоге был добавлен параметр "СПО", преобразованный в категориальный признак. Параметры "ЭКЕ" и "Жирность" были возведены в квадрат. Коэффициент итоговой линейной регрессии составил 0,82. Остатки регрессии распределены нормально и практически без смещений с отсутствием автокорреляции. Доверительный интервал полученных прогнозов (95%) показывает, что удои находятся в диапазоне от 6092.34 до 6221.38.

Также была построена логистическая регрессия для прогнозирования вкуса молока. В процессе калибровки был определен порог 0,8, который сводит к минимуму ошибку прогнозирования вкуса молока (ошибку первого рода, при которой вкус молока прогнозируется вкусным, хотя в реальности таковым не является).

По итогу построения линейной и логистической регрессий было выявлено, что в покупаемом стаде присутствуют 2 коровы, дающих одновременно приемлемый уровень удоя (не менее 6000 кг) и вкусное молоко. 
